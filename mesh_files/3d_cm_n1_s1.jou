#!python

f2_name = "3d_cm_n1_s1.e"
output_path_2 ="C:\\Users\\wliu\\OneDrive - Structural Integrity Associates Inc\\Projects\\DOE_2021\\cubit\\exodus\\"+f2_name
#output_path_2 ="..\\output\\"+f2_name

scale  = 1.0
length = 200

# functions
def list2str(l):
  s=""
  for a in l:
    s = s+" " + str(a)
  return s

def create_vertex(list_points):
  for a in list_points:
    cubit.cmd("create vertex " + str(a[0]) + '  ' + str(a[1]))

def create_curves(list_curves):
  for a in list_curves:
    cubit.cmd("create  curve vertex " + str(a[0]) + '  ' + str(a[1]))

def create_arcs(list_arcs):
  for a in list_arcs:
    cubit.cmd("create  curve arc vertex " + str(a[0]) + '  ' + str(a[1]) + '  radius  ' + str(a[2]) + '  normal 0 0 1 '  )

def create_surfaces(list_surfaces):
  for a in list_surfaces:
    cubit.cmd("create surface curve " + list2str(a))


list_points = [ (6.3, 0.0), (4.77, 1.53), (2.386, 2.386), (5.28, 0.0), (4.48, 1.13), (2.1036, 2.1036), (0, 0), (1.1, 0), (0.55, 0.55)]
create_vertex(list_points)

list_arcs =    [(1, 2, 1.53), (3, 2, 2.97), (4,5, 1.2), (6, 5, 3.32)]
create_arcs(list_arcs)

list_curves = [(1,4), (2,5), (3,6), (7,8), (7,9), (8,9), (8,4), (9,6)]
create_curves(list_curves)

list_curves_clad = [2, 4, 3, 1, 5, 7]
list_curves_fuel  = [11, 4, 3, 10, 12]
list_curves_displacer = [9, 10, 8 ]

list_surfaces = [list_curves_clad, list_curves_fuel, list_curves_displacer]

create_surfaces(list_surfaces)

cubit.cmd('delete curve 6')
cubit.cmd('merge curve all')

cubit.cmd('surface 1 2 3 copy reflect -1 1 0')
cubit.cmd('surface 1 2 3 4 5 6 copy reflect -1 0 0')
cubit.cmd('surface 1 2 3 4 5 6 7 8 9 10 11 12 copy reflect 0 -1 0')

cubit.cmd('merge curve all')
cubit.cmd('delete surface 3 6 12 9 21 24 18 15 ')
cubit.cmd('create surface curve 10 22 44 33 77 88 66 55 ')
cubit.cmd('surface all size auto factor 8')
cubit.cmd('mesh surface all')

list_vol_clad = range(26, 41, 2)
list_vol_fuel = range(27, 42, 2)
list_vol_displacer = [42]

cubit.cmd('sweep surface all helix zaxis thread_distance ' + str(length) + ' angle 90 right_handed  include_mesh  keep ')

cubit.cmd("volume all scale X 1 Y 1 Z  "  + str(scale) )

#cubit.cmd('sweep surface 114 144 129 69 84 54 39 99 154 137 122 62 77 47 32 92 107  helix zaxis thread_distance ' + str(length/scale) + ' angle 90 right_handed  include_mesh  keep ')

cubit.cmd('merge surface all')
cubit.cmd('merge curve all')


#create blocks
cubit.cmd('block 1 volume ' + list2str(list_vol_fuel))
cubit.cmd('block 2 volume ' + list2str(list_vol_clad))
cubit.cmd('block 3 volume ' + list2str(list_vol_displacer))

cubit.cmd('delete mesh volume 42 propagate')
cubit.cmd('merge surface all')
cubit.cmd('mesh volume 42')

cubit.cmd('volume all scale 0.001')
cubit.cmd('block all element type HEX8')



#create sidesets
list_outer_surface = [26,27,44,45,59,60,71,72,89,90,101,102,116,117, 134,135]

#list_bottom_surface = [1,2,4,5,7,8,10,11,13,14,16,17,19,20,22,23,25]
cubit.cmd('sideset 3 add surface' + list2str(list_outer_surface))
#cubit.cmd('sideset 4 add surface' + list2str(list_bottom_surface))

cubit.cmd('export genesis"' + output_path_2 + '" dimension 3 overwrite')












